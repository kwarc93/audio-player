/*
 * wave.c
 *
 *  Created on: 01.11.2017
 *      Author: Kwarc
 */


// +--------------------------------------------------------------------------
// | @ Includes
// +--------------------------------------------------------------------------
#include "decoder.h"

#include "FatFs/ff.h"

#include <stdbool.h>
// +--------------------------------------------------------------------------
// | @ Defines
// +--------------------------------------------------------------------------

// +--------------------------------------------------------------------------
// | @ Public variables
// +--------------------------------------------------------------------------

// +--------------------------------------------------------------------------
// | @ Private variables
// +--------------------------------------------------------------------------
static struct audio_decoder* decoder;
// +--------------------------------------------------------------------------
// | @ Private functions
// +--------------------------------------------------------------------------

// +--------------------------------------------------------------------------
// | @ Public functions
// +--------------------------------------------------------------------------
_Bool WAVE_Init(struct audio_decoder* main_decoder)
{
	decoder = main_decoder;
	return true;
}

_Bool WAVE_Decode(void)
{
	UINT bytes_read;

	decoder->song.result = f_read(&decoder->song.file, decoder->buffers.out_ptr,
						   sizeof(decoder->buffers.out)/2, &bytes_read);

	if(bytes_read != sizeof(decoder->buffers.out)/2 || decoder->song.result != FR_OK)
	{
		return false;
	}

	return true;
}

_Bool WAVE_Deinit(void)
{
	return true;
}
// +--------------------------------------------------------------------------
// | @ Interrupt handlers
// +--------------------------------------------------------------------------
